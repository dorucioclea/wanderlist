{"ast":null,"code":"import _toConsumableArray from \"/Users/peterzernia/projects/countries/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/peterzernia/projects/countries/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/peterzernia/projects/countries/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/peterzernia/projects/countries/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/peterzernia/projects/countries/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/peterzernia/projects/countries/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/peterzernia/projects/countries/src/containers/Search.js\";\nimport React, { Component } from 'react';\nimport { bindActionCreators } from 'redux';\nimport PropTypes from 'prop-types';\nimport CountryModal from '../components/CountryModal';\nimport Results from '../components/Results';\nimport SearchBar from '../components/SearchBar';\nimport { connect } from 'react-redux';\nimport { fetchCountry } from '../actions/countryActions';\nimport { putUserData } from '../actions/userActions';\nimport { openCountryModal, closeCountryModal } from '../actions/modalActions';\nimport { DotLoader } from 'react-spinners';\n\nvar Search =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Search, _Component);\n\n  function Search() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Search);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Search)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.handleSubmit = function (e) {\n      e.preventDefault();\n\n      _this.props.fetchCountry(e.target.country.value);\n    };\n\n    _this.handleClick = function (e) {\n      e.preventDefault(); // Resets newCountry to null at the beginning of every function call.\n\n      var newCountry = null;\n      var newCountryList; // Sets newCountry equal to the searchedCountry array. Then filters a copy\n      // itself to not mutate searchCountry.\n\n      newCountry = _this.props.searchedCountry;\n      newCountry = _toConsumableArray(newCountry).filter(function (country) {\n        return country.id === Number(e.target.id);\n      })[0]; // Checks if the userCountries array is empty and assigns just the new\n      // country if it is.\n\n      if (_this.props.userCountries.length === 0) {\n        newCountryList = [newCountry.id]; // Checks to see if the new country is already in the userCountries array\n        // and if not, adds it.\n      } else if (_this.props.userCountries.findIndex(function (i) {\n        return i.name === newCountry.name;\n      }) === -1) {\n        newCountryList = _this.props.userCountries.concat([newCountry]); // Converts array of objects into array of object.ids.\n\n        newCountryList = newCountryList.map(function (country) {\n          return country.id;\n        }); // If country is already in the array, it gets removed.\n      } else {\n        newCountryList = _this.props.userCountries;\n        var index = newCountryList.findIndex(function (i) {\n          return i.name === newCountry.name;\n        }); // If the index === -1, it means the country is not in the array.\n\n        if (index !== -1) {\n          newCountryList.splice(index, 1); // Converts array of objects into array of object.ids.\n\n          newCountryList = newCountryList.map(function (country) {\n            return country.id;\n          });\n        }\n      } // Makes the PUT request.\n\n\n      _this.props.putUserData(_this.props.username, _this.props.email, newCountryList, _this.props.home.id);\n    };\n\n    return _this;\n  }\n\n  _createClass(Search, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var listCountries = this.props.searchedCountry.map(function (country) {\n        return React.createElement(\"div\", {\n          key: country.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 70\n          },\n          __self: this\n        }, React.createElement(Results, Object.assign({}, _this2.props, {\n          country: country,\n          handleClick: _this2.handleClick,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 70\n          },\n          __self: this\n        })), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 70\n          },\n          __self: this\n        }));\n      });\n      return React.createElement(\"div\", {\n        className: \"content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }, React.createElement(SearchBar, {\n        handleSubmit: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      }), \" \", React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      }), this.props.fetching && React.createElement(DotLoader, {\n        size: 50,\n        color: '#66bb6a',\n        className: \"content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      }), this.props.fetched && React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }, listCountries), React.createElement(CountryModal, Object.assign({}, this.props, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return Search;\n}(Component);\n\nvar mapState = function mapState(state) {\n  return {\n    username: state.user.user.username,\n    email: state.user.user.email,\n    home: state.user.user.home,\n    userCountries: state.user.user.countries,\n    authenticated: state.auth.authenticated,\n    searchedCountry: state.country.country,\n    fetched: state.country.fetched,\n    fetching: state.country.fetching,\n    showCountryModal: state.modal.showCountryModal,\n    modalCountry: state.modal.modalCountry\n  };\n};\n\nvar mapDispatch = function mapDispatch(dispatch) {\n  return bindActionCreators({\n    fetchCountry: fetchCountry,\n    putUserData: putUserData,\n    openCountryModal: openCountryModal,\n    closeCountryModal: closeCountryModal\n  }, dispatch);\n};\n\nexport default connect(mapState, mapDispatch)(Search);\nSearch.propTypes = {\n  username: PropTypes.string,\n  email: PropTypes.string,\n  home: PropTypes.object,\n  userCountries: PropTypes.array,\n  authenticated: PropTypes.bool,\n  searchedCountry: PropTypes.array,\n  fetched: PropTypes.bool,\n  fetching: PropTypes.bool,\n  showCountryModal: PropTypes.bool,\n  modalCountry: PropTypes.object,\n  fetchCountry: PropTypes.func,\n  putUserData: PropTypes.func,\n  openCountryModal: PropTypes.func,\n  closeCountryModal: PropTypes.func\n};","map":{"version":3,"sources":["/Users/peterzernia/projects/countries/src/containers/Search.js"],"names":["React","Component","bindActionCreators","PropTypes","CountryModal","Results","SearchBar","connect","fetchCountry","putUserData","openCountryModal","closeCountryModal","DotLoader","Search","handleSubmit","e","preventDefault","props","target","country","value","handleClick","newCountry","newCountryList","searchedCountry","filter","id","Number","userCountries","length","findIndex","i","name","concat","map","index","splice","username","email","home","listCountries","fetching","fetched","mapState","state","user","countries","authenticated","auth","showCountryModal","modal","modalCountry","mapDispatch","dispatch","propTypes","string","object","array","bool","func"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,kBAAT,QAAmC,OAAnC;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,YAAP,MAAyB,4BAAzB;AACA,OAAOC,OAAP,MAAoB,uBAApB;AACA,OAAOC,SAAP,MAAsB,yBAAtB;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,YAAT,QAA6B,2BAA7B;AACA,SAASC,WAAT,QAA4B,wBAA5B;AACA,SAASC,gBAAT,EAA2BC,iBAA3B,QAAoD,yBAApD;AACA,SAASC,SAAT,QAA0B,gBAA1B;;IAEMC,M;;;;;;;;;;;;;;;;;;UAEJC,Y,GAAe,UAACC,CAAD,EAAO;AACpBA,MAAAA,CAAC,CAACC,cAAF;;AACA,YAAKC,KAAL,CAAWT,YAAX,CAAwBO,CAAC,CAACG,MAAF,CAASC,OAAT,CAAiBC,KAAzC;AACD,K;;UAUDC,W,GAAc,UAACN,CAAD,EAAO;AACnBA,MAAAA,CAAC,CAACC,cAAF,GADmB,CAEnB;;AACA,UAAIM,UAAU,GAAG,IAAjB;AACA,UAAIC,cAAJ,CAJmB,CAKnB;AACA;;AACAD,MAAAA,UAAU,GAAG,MAAKL,KAAL,CAAWO,eAAxB;AACAF,MAAAA,UAAU,GAAG,mBAAIA,UAAJ,EAAgBG,MAAhB,CAAuB,UAAAN,OAAO;AAAA,eAAIA,OAAO,CAACO,EAAR,KAAeC,MAAM,CAACZ,CAAC,CAACG,MAAF,CAASQ,EAAV,CAAzB;AAAA,OAA9B,EAAsE,CAAtE,CAAb,CARmB,CASnB;AACA;;AACA,UAAI,MAAKT,KAAL,CAAWW,aAAX,CAAyBC,MAAzB,KAAoC,CAAxC,EAA2C;AACzCN,QAAAA,cAAc,GAAG,CAACD,UAAU,CAACI,EAAZ,CAAjB,CADyC,CAE3C;AACA;AACC,OAJD,MAIO,IAAI,MAAKT,KAAL,CAAWW,aAAX,CAAyBE,SAAzB,CAAmC,UAAAC,CAAC;AAAA,eAAIA,CAAC,CAACC,IAAF,KAAWV,UAAU,CAACU,IAA1B;AAAA,OAApC,MAAwE,CAAC,CAA7E,EAAgF;AACrFT,QAAAA,cAAc,GAAG,MAAKN,KAAL,CAAWW,aAAX,CAAyBK,MAAzB,CAAgC,CAACX,UAAD,CAAhC,CAAjB,CADqF,CAErF;;AACAC,QAAAA,cAAc,GAAGA,cAAc,CAACW,GAAf,CAAmB,UAAAf,OAAO;AAAA,iBAAIA,OAAO,CAACO,EAAZ;AAAA,SAA1B,CAAjB,CAHqF,CAIvF;AACC,OALM,MAKA;AACLH,QAAAA,cAAc,GAAG,MAAKN,KAAL,CAAWW,aAA5B;AACA,YAAIO,KAAK,GAAGZ,cAAc,CAACO,SAAf,CAAyB,UAAAC,CAAC;AAAA,iBAAIA,CAAC,CAACC,IAAF,KAAWV,UAAU,CAACU,IAA1B;AAAA,SAA1B,CAAZ,CAFK,CAGL;;AACA,YAAIG,KAAK,KAAK,CAAC,CAAf,EAAiB;AACfZ,UAAAA,cAAc,CAACa,MAAf,CAAsBD,KAAtB,EAA6B,CAA7B,EADe,CAEf;;AACAZ,UAAAA,cAAc,GAAGA,cAAc,CAACW,GAAf,CAAmB,UAAAf,OAAO;AAAA,mBAAIA,OAAO,CAACO,EAAZ;AAAA,WAA1B,CAAjB;AACD;AACF,OA7BkB,CA8BnB;;;AACA,YAAKT,KAAL,CAAWR,WAAX,CACE,MAAKQ,KAAL,CAAWoB,QADb,EAEE,MAAKpB,KAAL,CAAWqB,KAFb,EAGEf,cAHF,EAIE,MAAKN,KAAL,CAAWsB,IAAX,CAAgBb,EAJlB;AAMD,K;;;;;;;6BAEQ;AAAA;;AAEP,UAAMc,aAAa,GAAG,KAAKvB,KAAL,CAAWO,eAAX,CAA2BU,GAA3B,CAA+B,UAAAf,OAAO;AAAA,eAC1D;AAAK,UAAA,GAAG,EAAEA,OAAO,CAACO,EAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAsB,oBAAC,OAAD,oBAAa,MAAI,CAACT,KAAlB;AAAyB,UAAA,OAAO,EAAEE,OAAlC;AAA2C,UAAA,WAAW,EAAE,MAAI,CAACE,WAA7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAtB,EAAiG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAjG,CAD0D;AAAA,OAAtC,CAAtB;AAIE,aACE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,SAAD;AAAW,QAAA,YAAY,EAAE,KAAKP,YAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,OACiD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADjD,EAEG,KAAKG,KAAL,CAAWwB,QAAX,IAAuB,oBAAC,SAAD;AAAW,QAAA,IAAI,EAAE,EAAjB;AAAqB,QAAA,KAAK,EAAE,SAA5B;AAAuC,QAAA,SAAS,EAAC,SAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAF1B,EAGG,KAAKxB,KAAL,CAAWyB,OAAX,IAAsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAMF,aAAN,CAHzB,EAIE,oBAAC,YAAD,oBAAkB,KAAKvB,KAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAJF,CADF;AAQH;;;;EApEkBhB,S;;AAuErB,IAAM0C,QAAQ,GAAG,SAAXA,QAAW,CAAAC,KAAK,EAAI;AACxB,SAAO;AACLP,IAAAA,QAAQ,EAAEO,KAAK,CAACC,IAAN,CAAWA,IAAX,CAAgBR,QADrB;AAELC,IAAAA,KAAK,EAAEM,KAAK,CAACC,IAAN,CAAWA,IAAX,CAAgBP,KAFlB;AAGLC,IAAAA,IAAI,EAAEK,KAAK,CAACC,IAAN,CAAWA,IAAX,CAAgBN,IAHjB;AAILX,IAAAA,aAAa,EAAEgB,KAAK,CAACC,IAAN,CAAWA,IAAX,CAAgBC,SAJ1B;AAKLC,IAAAA,aAAa,EAAEH,KAAK,CAACI,IAAN,CAAWD,aALrB;AAMLvB,IAAAA,eAAe,EAAEoB,KAAK,CAACzB,OAAN,CAAcA,OAN1B;AAOLuB,IAAAA,OAAO,EAAEE,KAAK,CAACzB,OAAN,CAAcuB,OAPlB;AAQLD,IAAAA,QAAQ,EAAEG,KAAK,CAACzB,OAAN,CAAcsB,QARnB;AASLQ,IAAAA,gBAAgB,EAAEL,KAAK,CAACM,KAAN,CAAYD,gBATzB;AAULE,IAAAA,YAAY,EAAEP,KAAK,CAACM,KAAN,CAAYC;AAVrB,GAAP;AAYD,CAbD;;AAeA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAAAC,QAAQ,EAAI;AAC9B,SAAOnD,kBAAkB,CAAC;AACxBM,IAAAA,YAAY,EAAZA,YADwB;AAExBC,IAAAA,WAAW,EAAXA,WAFwB;AAGxBC,IAAAA,gBAAgB,EAAhBA,gBAHwB;AAIxBC,IAAAA,iBAAiB,EAAjBA;AAJwB,GAAD,EAKtB0C,QALsB,CAAzB;AAMD,CAPD;;AASA,eAAe9C,OAAO,CAACoC,QAAD,EAAWS,WAAX,CAAP,CAA+BvC,MAA/B,CAAf;AAEAA,MAAM,CAACyC,SAAP,GAAmB;AACjBjB,EAAAA,QAAQ,EAAElC,SAAS,CAACoD,MADH;AAEjBjB,EAAAA,KAAK,EAAEnC,SAAS,CAACoD,MAFA;AAGjBhB,EAAAA,IAAI,EAAEpC,SAAS,CAACqD,MAHC;AAIjB5B,EAAAA,aAAa,EAAEzB,SAAS,CAACsD,KAJR;AAKjBV,EAAAA,aAAa,EAAE5C,SAAS,CAACuD,IALR;AAMjBlC,EAAAA,eAAe,EAAErB,SAAS,CAACsD,KANV;AAOjBf,EAAAA,OAAO,EAAEvC,SAAS,CAACuD,IAPF;AAQjBjB,EAAAA,QAAQ,EAAEtC,SAAS,CAACuD,IARH;AASjBT,EAAAA,gBAAgB,EAAE9C,SAAS,CAACuD,IATX;AAUjBP,EAAAA,YAAY,EAAEhD,SAAS,CAACqD,MAVP;AAWjBhD,EAAAA,YAAY,EAAEL,SAAS,CAACwD,IAXP;AAYjBlD,EAAAA,WAAW,EAAEN,SAAS,CAACwD,IAZN;AAajBjD,EAAAA,gBAAgB,EAAEP,SAAS,CAACwD,IAbX;AAcjBhD,EAAAA,iBAAiB,EAAER,SAAS,CAACwD;AAdZ,CAAnB","sourcesContent":["import React, { Component } from 'react'\nimport { bindActionCreators } from 'redux'\nimport PropTypes from 'prop-types'\nimport CountryModal from '../components/CountryModal'\nimport Results from '../components/Results'\nimport SearchBar from '../components/SearchBar'\nimport { connect } from 'react-redux'\nimport { fetchCountry } from '../actions/countryActions'\nimport { putUserData } from '../actions/userActions'\nimport { openCountryModal, closeCountryModal } from '../actions/modalActions'\nimport { DotLoader } from 'react-spinners'\n\nclass Search extends Component {\n\n  handleSubmit = (e) => {\n    e.preventDefault();\n    this.props.fetchCountry(e.target.country.value);\n  }\n\n  /*\n  This function checks to see if the country is already in the user list,\n  adds it if it is not, and removes it if it is, then PUT requests the new list\n  to the Django API. The button in the Results component is given the\n  name = index of the array. Then e.target.name == the index of the clicked\n  country in the array of searchedCountry when clicked. From the array index,\n  the newCountry object is the searchedCountry[e.target.name].\n  */\n  handleClick = (e) => {\n    e.preventDefault();\n    // Resets newCountry to null at the beginning of every function call.\n    let newCountry = null;\n    let newCountryList\n    // Sets newCountry equal to the searchedCountry array. Then filters a copy\n    // itself to not mutate searchCountry.\n    newCountry = this.props.searchedCountry\n    newCountry = [...newCountry].filter(country => country.id === Number(e.target.id))[0]\n    // Checks if the userCountries array is empty and assigns just the new\n    // country if it is.\n    if (this.props.userCountries.length === 0) {\n      newCountryList = [newCountry.id]\n    // Checks to see if the new country is already in the userCountries array\n    // and if not, adds it.\n    } else if (this.props.userCountries.findIndex(i => i.name === newCountry.name) === -1) {\n      newCountryList = this.props.userCountries.concat([newCountry]);\n      // Converts array of objects into array of object.ids.\n      newCountryList = newCountryList.map(country => country.id);\n    // If country is already in the array, it gets removed.\n    } else {\n      newCountryList = this.props.userCountries;\n      let index = newCountryList.findIndex(i => i.name === newCountry.name);\n      // If the index === -1, it means the country is not in the array.\n      if (index !== -1){\n        newCountryList.splice(index, 1);\n        // Converts array of objects into array of object.ids.\n        newCountryList = newCountryList.map(country => country.id);\n      }\n    }\n    // Makes the PUT request.\n    this.props.putUserData(\n      this.props.username,\n      this.props.email,\n      newCountryList,\n      this.props.home.id\n    );\n  }\n\n  render() {\n\n    const listCountries = this.props.searchedCountry.map(country =>(\n      <div key={country.id}><Results {...this.props} country={country} handleClick={this.handleClick}/><br/></div>\n    ));\n\n      return (\n        <div className=\"content\">\n          <SearchBar handleSubmit={this.handleSubmit} /> <br/>\n          {this.props.fetching && <DotLoader size={50} color={'#66bb6a'} className=\"content\" />}\n          {this.props.fetched && <div>{listCountries}</div>}\n          <CountryModal {...this.props} />\n        </div>\n      );\n  }\n}\n\nconst mapState = state => {\n  return {\n    username: state.user.user.username,\n    email: state.user.user.email,\n    home: state.user.user.home,\n    userCountries: state.user.user.countries,\n    authenticated: state.auth.authenticated,\n    searchedCountry: state.country.country,\n    fetched: state.country.fetched,\n    fetching: state.country.fetching,\n    showCountryModal: state.modal.showCountryModal,\n    modalCountry: state.modal.modalCountry\n  };\n};\n\nconst mapDispatch = dispatch => {\n  return bindActionCreators({\n    fetchCountry,\n    putUserData,\n    openCountryModal,\n    closeCountryModal\n  }, dispatch);\n};\n\nexport default connect(mapState, mapDispatch)(Search);\n\nSearch.propTypes = {\n  username: PropTypes.string,\n  email: PropTypes.string,\n  home: PropTypes.object,\n  userCountries: PropTypes.array,\n  authenticated: PropTypes.bool,\n  searchedCountry: PropTypes.array,\n  fetched: PropTypes.bool,\n  fetching: PropTypes.bool,\n  showCountryModal: PropTypes.bool,\n  modalCountry: PropTypes.object,\n  fetchCountry: PropTypes.func,\n  putUserData: PropTypes.func,\n  openCountryModal: PropTypes.func,\n  closeCountryModal: PropTypes.func\n};\n"]},"metadata":{},"sourceType":"module"}