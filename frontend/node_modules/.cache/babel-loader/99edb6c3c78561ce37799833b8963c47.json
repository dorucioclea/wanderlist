{"ast":null,"code":"import _classCallCheck from \"/Users/peterzernia/projects/countries/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/peterzernia/projects/countries/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/peterzernia/projects/countries/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/peterzernia/projects/countries/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/peterzernia/projects/countries/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/peterzernia/projects/countries/src/containers/Search.js\";\nimport React, { Component } from 'react';\nimport { bindActionCreators } from 'redux';\nimport PropTypes from 'prop-types';\nimport CountryModal from '../components/CountryModal';\nimport Results from '../components/Results';\nimport SearchBar from '../components/SearchBar';\nimport { connect } from 'react-redux';\nimport { fetchCountry } from '../actions/countryActions';\nimport { putUserData } from '../actions/userActions';\nimport { openCountryModal, closeCountryModal } from '../actions/modalActions';\nimport { DotLoader } from 'react-spinners';\n\nvar Search =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Search, _Component);\n\n  function Search() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Search);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Search)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.handleSubmit = function (e) {\n      e.preventDefault();\n\n      _this.props.fetchCountry(e.target.country.value);\n    };\n\n    _this.handleClick = function (e) {\n      e.preventDefault();\n      var newCountryList = _this.props.userCountries;\n\n      var newCountry = _this.props.searchedCountry.filter(function (country) {\n        return country.id === Number(e.target.name);\n      })[0]; // Filter object out into new array of length 1, then take the first object.\n\n\n      if (_this.props.userCountries.findIndex(function (i) {\n        return i.name === newCountry.name;\n      }) === -1) {\n        newCountryList = _this.props.userCountries.concat([newCountry]);\n        newCountryList = newCountryList.map(function (country) {\n          return country.id;\n        }); // Convert array of objects into array of object.id\n      } else {\n        var index = newCountryList.findIndex(function (i) {\n          return i.name === newCountry.name;\n        });\n\n        if (index !== -1) {\n          newCountryList.splice(index, 1);\n          newCountryList = newCountryList.map(function (country) {\n            return country.id;\n          }); // Convert array of objects into array of object.id\n        }\n      }\n\n      _this.props.putUserData(_this.props.username, _this.props.email, newCountryList, _this.props.home.id);\n    };\n\n    return _this;\n  }\n\n  _createClass(Search, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var listCountries = this.props.searchedCountry.map(function (country) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 53\n          },\n          __self: this\n        }, React.createElement(Results, Object.assign({\n          key: country.id\n        }, _this2.props, {\n          country: country,\n          handleClick: _this2.handleClick,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 53\n          },\n          __self: this\n        })), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 53\n          },\n          __self: this\n        }));\n      });\n      return React.createElement(\"div\", {\n        className: \"content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57\n        },\n        __self: this\n      }, React.createElement(SearchBar, {\n        handleSubmit: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58\n        },\n        __self: this\n      }), \" \", React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58\n        },\n        __self: this\n      }), this.props.fetching && React.createElement(DotLoader, {\n        size: 50,\n        color: '#66bb6a',\n        className: \"content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 59\n        },\n        __self: this\n      }), this.props.fetched && React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60\n        },\n        __self: this\n      }, listCountries), React.createElement(CountryModal, Object.assign({}, this.props, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return Search;\n}(Component);\n\nvar mapState = function mapState(state) {\n  return {\n    username: state.user.user.username,\n    email: state.user.user.email,\n    home: state.user.user.home,\n    userCountries: state.user.user.countries,\n    authenticated: state.auth.authenticated,\n    searchedCountry: state.country.country,\n    fetched: state.country.fetched,\n    fetching: state.country.fetching,\n    showCountryModal: state.modal.showCountryModal,\n    modalCountry: state.modal.modalCountry\n  };\n};\n\nvar mapDispatch = function mapDispatch(dispatch) {\n  return bindActionCreators({\n    fetchCountry: fetchCountry,\n    putUserData: putUserData,\n    openCountryModal: openCountryModal,\n    closeCountryModal: closeCountryModal\n  }, dispatch);\n};\n\nexport default connect(mapState, mapDispatch)(Search);\nSearch.propTypes = {\n  username: PropTypes.string,\n  email: PropTypes.string,\n  home: PropTypes.object,\n  userCountries: PropTypes.array,\n  authenticated: PropTypes.bool,\n  searchedCountry: PropTypes.array,\n  fetched: PropTypes.bool,\n  fetching: PropTypes.bool,\n  showCountryModal: PropTypes.bool,\n  modalCountry: PropTypes.object,\n  fetchCountry: PropTypes.func,\n  putUserData: PropTypes.func,\n  openCountryModal: PropTypes.func,\n  closeCountryModal: PropTypes.func\n};","map":{"version":3,"sources":["/Users/peterzernia/projects/countries/src/containers/Search.js"],"names":["React","Component","bindActionCreators","PropTypes","CountryModal","Results","SearchBar","connect","fetchCountry","putUserData","openCountryModal","closeCountryModal","DotLoader","Search","handleSubmit","e","preventDefault","props","target","country","value","handleClick","newCountryList","userCountries","newCountry","searchedCountry","filter","id","Number","name","findIndex","i","concat","map","index","splice","username","email","home","listCountries","fetching","fetched","mapState","state","user","countries","authenticated","auth","showCountryModal","modal","modalCountry","mapDispatch","dispatch","propTypes","string","object","array","bool","func"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { bindActionCreators } from 'redux'\nimport PropTypes from 'prop-types'\nimport CountryModal from '../components/CountryModal'\nimport Results from '../components/Results'\nimport SearchBar from '../components/SearchBar'\nimport { connect } from 'react-redux'\nimport { fetchCountry } from '../actions/countryActions'\nimport { putUserData } from '../actions/userActions'\nimport { openCountryModal, closeCountryModal } from '../actions/modalActions'\nimport { DotLoader } from 'react-spinners'\n\nclass Search extends Component {\n\n  handleSubmit = (e) => {\n    e.preventDefault();\n    this.props.fetchCountry(e.target.country.value);\n  }\n\n  /*\n  This function checks to see if the country is already in the user list,\n  adds it if it is not, and removes it if it is, then PUT requests the new list\n  to the Django API. The button in the Results component is given the\n  name = index of the array. Then e.target.name == the index of the clicked\n  country in the array of searchedCountry when clicked. From the array index,\n  the newCountry object is the searchedCountry[e.target.name].\n  */\n  handleClick = (e) => {\n    e.preventDefault();\n    let newCountryList = this.props.userCountries\n    let newCountry = this.props.searchedCountry.filter(country => country.id === Number(e.target.name))[0] // Filter object out into new array of length 1, then take the first object.\n    if (this.props.userCountries.findIndex(i => i.name === newCountry.name) === -1) {\n      newCountryList = this.props.userCountries.concat([newCountry]);\n      newCountryList = newCountryList.map(country => country.id);  // Convert array of objects into array of object.id\n    } else {\n      let index = newCountryList.findIndex(i => i.name === newCountry.name);\n      if (index !== -1){\n        newCountryList.splice(index, 1);\n        newCountryList = newCountryList.map(country => country.id); // Convert array of objects into array of object.id\n      }\n    }\n    this.props.putUserData(\n      this.props.username,\n      this.props.email,\n      newCountryList,\n      this.props.home.id\n    );\n  }\n\n  render() {\n\n    const listCountries = this.props.searchedCountry.map(country =>(\n      <div><Results key={country.id} {...this.props} country={country} handleClick={this.handleClick}/><br/></div>\n    ));\n\n      return (\n        <div className=\"content\">\n          <SearchBar handleSubmit={this.handleSubmit} /> <br/>\n          {this.props.fetching && <DotLoader size={50} color={'#66bb6a'} className=\"content\" />}\n          {this.props.fetched && <div>{listCountries}</div>}\n          <CountryModal {...this.props} />\n        </div>\n      );\n  }\n}\n\nconst mapState = state => {\n  return {\n    username: state.user.user.username,\n    email: state.user.user.email,\n    home: state.user.user.home,\n    userCountries: state.user.user.countries,\n    authenticated: state.auth.authenticated,\n    searchedCountry: state.country.country,\n    fetched: state.country.fetched,\n    fetching: state.country.fetching,\n    showCountryModal: state.modal.showCountryModal,\n    modalCountry: state.modal.modalCountry\n  };\n};\n\nconst mapDispatch = dispatch => {\n  return bindActionCreators({\n    fetchCountry,\n    putUserData,\n    openCountryModal,\n    closeCountryModal\n  }, dispatch);\n};\n\nexport default connect(mapState, mapDispatch)(Search);\n\nSearch.propTypes = {\n  username: PropTypes.string,\n  email: PropTypes.string,\n  home: PropTypes.object,\n  userCountries: PropTypes.array,\n  authenticated: PropTypes.bool,\n  searchedCountry: PropTypes.array,\n  fetched: PropTypes.bool,\n  fetching: PropTypes.bool,\n  showCountryModal: PropTypes.bool,\n  modalCountry: PropTypes.object,\n  fetchCountry: PropTypes.func,\n  putUserData: PropTypes.func,\n  openCountryModal: PropTypes.func,\n  closeCountryModal: PropTypes.func\n};\n"]},"metadata":{},"sourceType":"module"}